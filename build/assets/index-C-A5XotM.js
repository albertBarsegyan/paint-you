import{r,j as x}from"./index-CyKPuI_L.js";import{u as z,d as j,g as M}from"./canvas-Bv63vBbW.js";import"./react-vendors-DJG_os-6.js";const _="_wrapper_13kmo_8",y={wrapper:_},P="white",X=()=>{const{state:{isDrawing:p,brushColor:g,brushSize:d,currentStroke:f,strokes:a,width:T,height:D},canvasRef:u,setDrawing:h,changeStrokes:R,changeCurrentStroke:o}=z(),C=r.useRef(p),n=r.useRef(f),m=r.useRef({color:g,size:d});r.useEffect(()=>{C.current=p,n.current=f,m.current={color:g,size:d}},[p,f,g,d]);const c=r.useRef(null),s=r.useRef(null),k=r.useCallback((t,e)=>{!C.current||!n.current||s.current&&Math.abs(s.current.x-t)<2&&Math.abs(s.current.y-e)<2||(s.current={x:t,y:e},c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame(()=>{o({...n.current,points:[...n.current.points,{x:t,y:e}]})}))},[o]),A=t=>{k(t.clientX-t.currentTarget.getBoundingClientRect().left,t.clientY-t.currentTarget.getBoundingClientRect().top)},w=r.useCallback(j,[]),v=r.useCallback((t,e)=>{o({points:[{x:t,y:e}],color:m.current.color,size:m.current.size}),h(!0),s.current={x:t,y:e}},[o,h]),E=t=>{v(t.clientX-t.currentTarget.getBoundingClientRect().left,t.clientY-t.currentTarget.getBoundingClientRect().top)},b=r.useCallback(()=>{c.current&&cancelAnimationFrame(c.current),n.current&&(R([...a,n.current]),o(null)),h(!1),s.current=null},[o,R,h,a]),S=r.useCallback(()=>{const t=u.current;if(!t)return;const e=t.getContext("2d");e&&(e.fillStyle=P,e.fillRect(0,0,t.width,t.height),a.forEach(i=>{w(e,i)}),n.current&&w(e,n.current))},[u,w,a]),F=t=>{t.preventDefault();const e=u.current;if(!e)return;const i=t.touches[0],l=M(e,i);v(l.x,l.y)},B=t=>{t.preventDefault();const e=u.current;if(!e)return;const i=t.touches[0],l=M(e,i);k(l.x,l.y)};return r.useEffect(()=>()=>{c.current&&cancelAnimationFrame(c.current)},[]),r.useEffect(()=>{const t=requestAnimationFrame(S);return()=>cancelAnimationFrame(t)},[S,a,f]),x.jsx("div",{className:y.wrapper,children:x.jsx("canvas",{ref:u,width:T,height:D,onMouseDown:E,onMouseMove:A,onMouseUp:b,onTouchStart:F,onTouchMove:B,onTouchEnd:b,style:{boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",cursor:"crosshair"}})})};export{X as default};
